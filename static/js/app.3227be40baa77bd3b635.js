webpackJsonp([1,0],[function(s,t,i){"use strict";function o(s){return s&&s.__esModule?s:{default:s}}var e=i(9),r=o(e),l=i(5),a=o(l),h=i(4);o(h);new r.default({el:"#app",template:"<App/>",components:{App:a.default}})},,function(s,t){},function(s,t){},function(s,t){},function(s,t,i){i(2);var o=i(1)(i(10),i(7),null,null);s.exports=o.exports},function(s,t,i){i(3);var o=i(1)(i(11),i(8),"data-v-9c4af09a",null);s.exports=o.exports},function(s,t){s.exports={render:function(){var s=this,t=s.$createElement,i=s._self._c||t;return i("div",{attrs:{id:"app"}},[i("header"),s._v(" "),i("div",{staticClass:"body"},[i("div",{staticClass:"left"}),s._v(" "),i("aside",{staticClass:"center"},[i("board")],1),s._v(" "),i("div",{staticClass:"right"})]),s._v(" "),i("footer")])},staticRenderFns:[]}},function(s,t){s.exports={render:function(){var s=this,t=s.$createElement,i=s._self._c||t;return i("div",[i("div",{staticClass:"top"},[i("button",{on:{click:s.startGame}},[s._v("开始游戏")]),s._v(" "),i("div",[i("span",[s._v("combo：")]),s._v(" "),i("span",[s._v(s._s(s.combo))])]),s._v(" "),i("div",[i("span",[s._v("当前得分：")]),s._v(" "),i("span",[s._v(s._s(s.score))])]),s._v(" "),i("span",[s._v(s._s(s.time))]),s._v(" "),i("progress",{staticClass:"progress is-primary",staticStyle:{"max-width":"400px"},attrs:{value:s.timeProgress,max:"100"}})]),s._v(" "),i("div",{staticClass:"board"},s._l(s.showMaps,function(t,o){return i("div",{staticClass:"row"},s._l(t,function(t){return i("div",{staticClass:"cell",class:{cell_r:"R"==t.color,cell_b:"B"==t.color,cell_g:"G"==t.color,cell_y:"Y"==t.color,cell_click:t.click,moveUp:s.isMoveUp(t),moveDown:s.isMoveDown(t),moveLeft:s.isMoveLeft(t),moveRight:s.isMoveRight(t)},on:{click:function(i){s.mouseClick(t)}}})}))})),s._v(" "),i("div",{staticClass:"bottom"})])},staticRenderFns:[]}},,function(s,t,i){"use strict";function o(s){return s&&s.__esModule?s:{default:s}}Object.defineProperty(t,"__esModule",{value:!0});var e=i(6),r=o(e);t.default={name:"app",components:{Board:r.default}}},function(s,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={components:{},data:function(){return{maps:[],showMaps:[],colors:[],xSize:8,ySize:8,removeList:[],sourceCell:null,targetCell:null,removingFlag:!1,score:0,combo:0,timeProgress:100,gameTime:60,startFlag:!1}},mounted:function(){for(this.initMaps();this.isDieMap();)this.initMaps();this.refreshMaps()},computed:{time:function s(){var s=(this.timeProgress/100*this.gameTime).toString().split(".");return 2==s.length?s[0]+"."+s[1].substr(0,3):s[0]}},methods:{startGame:function(){var s=this;if(!this.startFlag){this.startFlag=!0,this.timeProgress=100,this.score=0;var t=new Date;t.setSeconds(t.getSeconds()+this.gameTime);var i=setInterval(function(){t<=new Date?(clearInterval(i),s.timeProgress=0,s.startFlag=!1,console.log("时间到")):s.timeProgress=(t-new Date)/s.gameTime/10},1)}},initMaps:function(){for(var s=0;s<this.ySize;s++)this.maps[s]=[];this.initColors();for(var t=0;t<this.ySize;t++)for(var i=0;i<this.xSize;i++){if(!(this.colors.length>0))return void this.initMaps();var o={},e=parseInt(Math.random()*this.colors.length,10);o.color=this.colors[e],o.x=t,o.y=i,this.maps[t][i]=o,this.isLine(t,i)?(i-=1,this.colors.splice(e,1)):this.initColors()}},initColors:function(){this.colors=["R","B","G","Y"]},isLine:function(s,t){var i=s-1>-1,o=s-2>-1,e=s+1<this.xSize,r=s+2<this.xSize,l=t-1>-1,a=t-2>-1,h=t+1<this.ySize,n=t+2<this.ySize;return!!(l&&h&&this.isCellColorEqual(this.maps[s][t-1],this.maps[s][t],this.maps[s][t+1]))||(!!(i&&e&&this.isCellColorEqual(this.maps[s-1][t],this.maps[s][t],this.maps[s+1][t]))||(!(!a||!this.isCellColorEqual(this.maps[s][t],this.maps[s][t-1],this.maps[s][t-2]))||(!(!n||!this.isCellColorEqual(this.maps[s][t],this.maps[s][t+1],this.maps[s][t+2]))||(!(!o||!this.isCellColorEqual(this.maps[s][t],this.maps[s-1][t],this.maps[s-2][t]))||r&&this.isCellColorEqual(this.maps[s][t],this.maps[s+1][t],this.maps[s+2][t])))))},isCellColorEqual:function(s,t,i){return!!(s&&t&&i&&s.color&&t.color&&i.color)&&(s.color==t.color&&s.color==i.color)},isDieMap:function(){for(var s=0;s<this.xSize;s++)for(var t=0;t<this.ySize;t++)if(this.maps[s][t].x=s,this.maps[s][t].y=t,0==this.isDie(s,t))return!1;return!0},isDie:function(s,t){var i=s-1>-1,o=s-2>-1,e=s-3>-1,r=s+1<this.xSize,l=s+2<this.xSize,a=s+3<this.xSize,h=t-1>-1,n=t-2>-1,c=t-3>-1,u=t+1<this.ySize,m=t+2<this.ySize,p=t+3<this.ySize,f=this.maps[s][t].color;if(r){if(this.maps[s+1][t].color==f){if(a&&this.maps[s+3][t].color==f)return!1;if(l&&u&&this.maps[s+2][t+1].color==f)return!1;if(l&&h&&this.maps[s+2][t-1].color==f)return!1;if(o&&this.maps[s-2][t].color==f)return!1;if(i&&h&&this.maps[s-1][t-1].color==f)return!1;if(i&&u&&this.maps[s-1][t+1].color==f)return!1}if(h&&u&&this.maps[s+1][t-1].color==f&&this.maps[s+1][t+1].color==f)return!1}if(i){if(this.maps[s-1][t].color==f){if(e&&this.maps[s-3][t].color==f)return!1;if(o&&u&&this.maps[s-2][t+1].color==f)return!1;if(o&&h&&this.maps[s-2][t-1].color==f)return!1;if(l&&this.maps[s+2][t].color==f)return!1;if(r&&h&&this.maps[s+1][t-1].color==f)return!1;if(r&&u&&this.maps[s+1][t+1].color==f)return!1}if(h&&u&&this.maps[s-1][t-1].color==f&&this.maps[s-1][t+1].color==f)return!1}if(u){if(this.maps[s][t+1].color==f){if(p&&this.maps[s][t+3].color==f)return!1;if(i&&m&&this.maps[s-1][t+2].color==f)return!1;if(r&&m&&this.maps[s+1][t+2].color==f)return!1;if(n&&this.maps[s][t-2].color==f)return!1;if(r&&h&&this.maps[s+1][t-1].color==f)return!1;if(i&&h&&this.maps[s-1][t-1].color==f)return!1}if(i&&r&&this.maps[s-1][t+1].color==f&&this.maps[s+1][t+1].color==f)return!1}if(h){if(this.maps[s][t-1].color==f){if(c&&this.maps[s][t-3].color==f)return!1;if(i&&n&&this.maps[s-1][t-2].color==f)return!1;if(r&&n&&this.maps[s+1][t-2].color==f)return!1;if(m&&this.maps[s][t+2].color==f)return!1;if(r&&u&&this.maps[s+1][t+1].color==f)return!1;if(i&&u&&this.maps[s-1][t+1].color==f)return!1}if(i&&r&&this.maps[s-1][t-1].color==f&&this.maps[s+1][t-1].color==f)return!1}return!0},move:function(s,t){var i=this.maps[s.x][s.y].color,o=this.maps[t.x][t.y].color;return this.maps[t.x][t.y].color=i,this.maps[s.x][s.y].color=o,this.isLine(s.x,s.y)||this.isLine(t.x,t.y)?void this.fadeCircle():(this.maps[s.x][s.y].color=i,this.maps[t.x][t.y].color=o,this.sourceCell=null,this.removingFlag=!1,void console.log("no eliminate cell"))},near:function(s,t){var i=s.x==t.x&&(s.y==t.y+1||s.y==t.y-1)||s.y==t.y&&(s.x==t.x+1||s.x==t.x-1);return s.x>-1&&s.x<this.xSize&&s.y>-1&&s.y<this.ySize&&t.x>-1&&t.x<this.xSize&&t.y>-1&&t.y<this.ySize&&i},fadeCircle:function(){this.calcToRemoveList(),this.removeAndDownCell()},calcToRemoveList:function(){var s=this;this.removeList=[];for(var t=0;t<this.xSize;t++)for(var i=0;i<this.ySize;i++){var o=t+"_"+i;if(this.maps[t][i]&&this.removeList.indexOf(o)==-1){var e=[],r=[];this.sameCellColorLeft(t,i,this.maps[t][i].color,e),this.sameCellColorRight(t,i,this.maps[t][i].color,e),this.sameCellColorUp(t,i,this.maps[t][i].color,r),this.sameCellColorDown(t,i,this.maps[t][i].color,r),e.length>2&&(this.score+=e.length*(this.combo+1),e.forEach(function(t){s.removeList.push(t)})),r.length>2&&(this.score+=r.length*(this.combo+1),r.forEach(function(t){s.removeList.push(t)}))}}},removeAndDownCell:function(){var s=this;return 0==this.removeList.length?(this.removingFlag=!1,this.sourceCell=null,void(this.combo=0)):(this.combo++,this.removeList.forEach(function(t){s.maps[t.split("_")[0]][t.split("_")[1]].color=" "}),this.refreshMaps(),void window.setTimeout(function(){s.downCell()},400))},downCell:function(){var s=this;this.initColors(),this.removeList.sort(),this.removeList.forEach(function(t){for(var i=t.split("_")[0],o=t.split("_")[1];o>0;o--)s.maps[i][o].color=s.maps[i][o-1].color;var e=parseInt(Math.random()*s.colors.length,10);s.maps[i][0].color=s.colors[e]}),this.refreshMaps(),window.setTimeout(function(){s.fadeCircle()},400)},sameCellColorLeft:function(s,t,i,o){o.indexOf(s+"_"+t)==-1&&o.push(s+"_"+t);var e=s-1;e>=0&&this.maps[e][t]&&this.maps[e][t].color==i&&this.sameCellColorLeft(e,t,i,o)},sameCellColorRight:function(s,t,i,o){o.indexOf(s+"_"+t)==-1&&o.push(s+"_"+t);var e=s+1;e<this.xSize&&this.maps[e][t]&&this.maps[e][t].color==i&&this.sameCellColorRight(e,t,i,o)},sameCellColorUp:function(s,t,i,o){o.indexOf(s+"_"+t)==-1&&o.push(s+"_"+t);var e=t-1;e>=0&&this.maps[s][e]&&this.maps[s][e].color==i&&this.sameCellColorUp(s,e,i,o)},sameCellColorDown:function(s,t,i,o){o.indexOf(s+"_"+t)==-1&&o.push(s+"_"+t);var e=t+1;e<this.ySize&&this.maps[s][e]&&this.maps[s][e].color==i&&this.sameCellColorDown(s,e,i,o)},mouseClick:function(s){var t=this;if(this.startFlag&&0!=this.timeProgress&&!this.removingFlag)if(null!=this.sourceCell){if(this.maps[this.sourceCell.x][this.sourceCell.y].click=!1,!this.near(this.sourceCell,s))return s.click=!0,this.sourceCell=s,this.refreshMaps(),void console.log("not near");this.removingFlag=!0,this.targetCell=s,window.setTimeout(function(){t.move(t.sourceCell,s)},500)}else this.sourceCell=s,this.sourceCell.click=!0,this.refreshMaps()},isMoveUp:function(s){return!!this.removingFlag&&(this.sourceCell.x==this.targetCell.x&&(s.x==this.sourceCell.x&&s.y==this.sourceCell.y?s.y==this.targetCell.y+1:s.x==this.targetCell.x&&s.y==this.targetCell.y?s.y==this.sourceCell.y+1:void 0))},isMoveDown:function(s){return!!this.removingFlag&&(this.sourceCell.x==this.targetCell.x&&(s.x==this.sourceCell.x&&s.y==this.sourceCell.y?s.y==this.targetCell.y-1:s.x==this.targetCell.x&&s.y==this.targetCell.y?s.y==this.sourceCell.y-1:void 0))},isMoveLeft:function(s){return!!this.removingFlag&&(this.sourceCell.y==this.targetCell.y&&(s.x==this.sourceCell.x&&s.y==this.sourceCell.y?s.x==this.targetCell.x+1:s.x==this.targetCell.x&&s.y==this.targetCell.y?s.x==this.sourceCell.x+1:void 0))},isMoveRight:function(s){return!!this.removingFlag&&(this.sourceCell.y==this.targetCell.y&&(s.x==this.sourceCell.x&&s.y==this.sourceCell.y?s.x==this.targetCell.x-1:s.x==this.targetCell.x&&s.y==this.targetCell.y?s.x==this.sourceCell.x-1:void 0))},refreshMaps:function(){this.showMaps=[],this.showMaps=this.maps},printMaps:function(){for(var s=" \t",t=0;t<this.xSize;t++)s+=t+"\t";console.log(s);for(var i=0;i<this.xSize;i++){for(var o=i+"\t",e=0;e<this.ySize;e++)o+=this.maps[e][i].color+"\t";console.log(o)}}}}}]);
//# sourceMappingURL=app.3227be40baa77bd3b635.js.map